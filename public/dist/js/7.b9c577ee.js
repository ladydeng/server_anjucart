/*! 最终版权归**所有 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{237:function(t,e){},281:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"learning-infomation"},[i("header",{staticClass:"title"},[t._v("资讯管理")]),t._v(" "),i("el-divider"),t._v(" "),i("el-row",{ref:"test",staticClass:"boundary"},[i("el-button",{staticStyle:{"margin-left":"16px"},attrs:{size:"small",type:"primary"},on:{click:t.newAdd}},[t._v("\n      新增\n    ")])],1),t._v(" "),i("div",{staticClass:"table"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":{textAlign:"center",background:"#FAFAFA"},"cell-style":t.changeColor,stripe:""}},[i("el-table-column",{attrs:{type:"index",index:t.count,label:"序号",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"newsTitle",label:"标题"}}),t._v(" "),i("el-table-column",{attrs:{prop:"createDate",label:"创建日期"}}),t._v(" "),i("el-table-column",{attrs:{prop:"newsAuthor",label:"创建人"}}),t._v(" "),i("el-table-column",{attrs:{label:"是否发布"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{on:{change:function(i){return t.switchPublish(e.$index,e.row)}},model:{value:e.row.isPublish,callback:function(i){t.$set(e.row,"isPublish",i)},expression:"scope.row.isPublish"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(i){return t.clickEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-delete"},on:{click:function(i){return t.clickDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),i("div",{staticClass:"center-style"},[i("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogFormVisible,center:""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"标题:","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off",type:"text",placeholder:"请输入标题",maxlength:"40","show-word-limit":""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"创建人:","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off",type:"text",placeholder:"请输入创建人",maxlength:"40","show-word-limit":""},model:{value:t.form.author,callback:function(e){t.$set(t.form,"author",e)},expression:"form.author"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"封面:","label-width":t.formLabelWidth}},[i("el-upload",{attrs:{action:"http://192.168.124.12:8080/news/imageUpload","list-type":"picture-card","file-list":t.fileList,limit:1,"before-upload":t.handleUploadFileType,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.handleSuccess}},[i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible,"modal-append-to-body":!1,"append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),t._v(" "),i("wang-editor",{attrs:{content:t.content}})],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.clickCancel}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.clickConfirm}},[t._v("确 定")])],1)],1)],1)};o._withStripped=!0,i(244),i(270);var n=i(236),l=i.n(n);(a=function(){var t=this,e=t.$createElement;return(e=t._self._c||e)("div",{staticClass:"home"},[e("el-form-item",{attrs:{label:"内容:","label-width":t.formLabelWidth}},[e("div",{ref:"box"})])],1)})._withStripped=!0;var a,s=i(277),r=(n=i(278),i.n(n));n={name:"WangEditor",data:function(){return Object(s.a)({editor:null,editorData:"",formLabelWidth:"60px",imgSrc:""},"editor","")},props:{content:{type:String,default:""}},mounted:function(){var t=this,e=this.$refs.box;(e=new r.a(e)).config.uploadImgServer="http://192.168.124.12:8080/news/imageUpload",e.config.uploadFileName="file",e.config.debug=!0,e.config.uploadImgHooks={fail:function(t,e,i){console.log(i)},success:function(t,e,i){console.log(i)},customInsert:function(t,e){t(e.body.data[0]),console.log(e.body.data[0])}},e.config.onchange=function(e){t.editorData=e},e.config.height=500,e.config.zIndex=99,e.create(),this.editor=e,this.$bus.$on("sendHtml",(function(){console.log("接收到请求"),t.$bus.$emit("getHtml",t.editorData)})),e.txt.html(this.content),this.editor=e},watch:{content:function(t,e){this.editor.txt.html(t)}},methods:{getEditorData:function(){var t=this.editor.txt.html();alert(t)}},beforeDestroy:function(){this.editor.destroy(),this.editor=null}},i=i(79);(a=Object(i.a)(n,a,[],!1,null,"add16e0a",null)).options.__file="src/components/common/wangEditor/WangEditor.vue",a={name:"LearningInfomation",data:function(){return{tableData:[],dialogTableVisible:!1,dialogFormVisible:!1,dialogTitle:"",form:{title:"",author:"",imageSrc:"",html:""},formLabelWidth:"60px",dialogImageUrl:"",dialogVisible:!1,fileList:[],pageIndex:1,total:10,pageSize:10,content:""}},components:{WangEditor:a.exports},methods:{newAdd:function(){this.form.title="",this.form.author="",this.form.html="",this.fileList=[],this.content="",console.log("新增"),this.dialogFormVisible=!0,this.dialogTitle="新增一条资讯"},clickEdit:function(t,e){console.log("编辑"),this.dialogTitle="编辑资讯",console.log(e),this.form.title=e.newsTitle,this.form.author=e.newsAuthor,this.form.id=e.id;var i={name:"图片名称如avator.png",url:e.newsCover};this.fileList=[i],console.log(this.fileList),this.content=e.newsContent,this.dialogFormVisible=!0},clickDelete:function(t,e){var i=this;console.log("删除"),this.$confirm("此操作将永久该条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};i.axios.post("/news/deleteNews",l.a.stringify(t)).then((function(t){"删除成功"==t.data.msg&&(i.$message({type:"success",message:"删除成功!"}),i.findAll())}))})).catch((function(){i.$message({type:"info",message:"已取消删除！"})}))},changeColor:function(t){return t.row,t.column,t.rowIndex,6==(t=t.columnIndex)||7==t?"textAlign:center;cursor: pointer;":"textAlign:center;"},switchPublish:function(t,e){console.log(e.id+"是否发布"+e.isPublish),e.id,e.isPublish},clickConfirm:function(){var t=this;console.log("点击了对话框的确认"),this.$bus.$emit("sendHtml");var e,i,o=this.form.html.split(" "),n=[];for(e in o)-1!==o[e].indexOf("src=")&&(i=o[e].length-1,i=o[e].substring(5,i),n.push(i));n.push(this.form.imageSrc);var a={newsTitle:this.form.title,newsCover:this.form.imageSrc,newsContent:this.form.html,newsAuthor:this.form.author};"新增一条资讯"==this.dialogTitle?(console.log(l.a.stringify(a)+"&imageArray="+n),this.axios.post("/news/createNews",l.a.stringify(a)+"&imageArray="+n).then((function(e){console.log(e),"操作成功"==e.data.msg?(t.$notify({title:"提示",message:"新增资讯成功！",type:"success"}),t.findAll(),t.dialogFormVisible=!1):t.$notify.error({title:"提示",message:"新增资讯失败！"})}))):"编辑资讯"==this.dialogTitle&&(console.log(l.a.stringify(a)+"&id="+this.form.id),this.axios.post("/news/updateNews",l.a.stringify(a)+"&id="+this.form.id).then((function(e){"修改成功"==e.data.msg?(t.$notify({title:"提示",message:"修改成功！",type:"success"}),t.findAll(),t.dialogFormVisible=!1):t.$notify.error({title:"提示",message:"修改失败！"})})))},clickCancel:function(){console.log("点击了对话框的取消"),this.dialogFormVisible=!1},handleRemove:function(t,e){var i=this;console.log("删除成功");var o={filePath:this.form.imageSrc};console.log(l.a.stringify(o)),this.axios.post("/news/deleteFile",l.a.stringify(o)).then((function(t){console.log(t),200==t.status&&i.$message({message:"删除成功！",type:"success"})}))},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleUploadFileType:function(t){var e="image/jpeg"===t.type,i="image/jpg"===t.type,o="image/png"===t.type;t="image/gif"===t.type;return e||i||o||t||this.$message.error("上传头像图片只能是JPEG、JPG、PNG、GIF格式!"),e||i||o||t},handleSuccess:function(t,e,i){console.log("图片上传成功"),console.log(e),this.form.imageSrc=e.response.body.data[0]},handleSizeChange:function(){},handleCurrentChange:function(){},count:function(t){return(this.pageIndex-1)*this.pageSize+t+1},findAll:function(){var t=this;this.axios.get("/news/getNews?pageSize="+this.pageSize+"&pageIndex="+this.pageIndex).then((function(e){t.tableData=e.data.body.projectList,t.total=e.data.body.total,console.log(e),console.log("刷新页面成功")}))}},mounted:function(){var t=this;this.findAll(),this.$bus.$on("getHtml",(function(e){console.log("接收到数据"),t.form.html=e}))}},(o=Object(i.a)(a,o,[],!1,null,"3a16b099",null)).options.__file="src/components/content/learningInfomation/LearningInfomation.vue",e.default=o.exports}}]);